"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE)
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(total = rowSums(across(where(is.numeric))))
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(total = rowSums(across(where(is.numeric)))) %>%
pivot_longer(!entity, names_to = "category", values_to = "value") %>%
mutate(
category = case_when(
category == "human_food" ~ "Human Food",
category == "animal_feed" ~ "Animal Feed",
category == "processed" ~ "Processed",
TRUE ~ category)) %>%
mutate(ID = row_number()) %>%
filter(value > 0) %>%
mutate(continent = ifelse((entity %in% "Africa") |
(entity %in% "Europe") |
(entity %in% "Asia") |
(entity %in% "North America") |
(entity %in% "South America") |
(entity %in% "Oceania"), "Yes", "No"))
View(soybean_clean)
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(Total)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(Total, 25)
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(25)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
entity == "Northern America" ~ "North America",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(25, Total)
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Africa",
"Asia",
"Europe",
"Oceania",
"Northern America",
"South America",
"Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(25, Total)
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Africa",
"Asia",
"Europe",
"Oceania",
"Northern America",
"South America",
"Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Asia",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(25, Total)
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Africa",
"Asia",
"Europe",
"Oceania",
"Northern America",
"South America",
"Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Asia",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(25, Total) %>%
pivot_longer(!entity, names_to = "category", values_to = "value") %>%
mutate(
category = case_when(
category == "human_food" ~ "Human Food",
category == "animal_feed" ~ "Animal Feed",
category == "processed" ~ "Processed",
TRUE ~ category))
View(soybean_clean)
soybean_clean <- soybean_use %>%
filter(between(year, 2000, 2013)) %>%
filter(!entity %in% c("Africa",
"Asia",
"Europe",
"Oceania",
"Northern America",
"South America",
"Americas",
"Asia, Central",
"Australia & New Zealand",
"Central America",
"Eastern Asia",
"Eastern Africa",
"Eastern Europe",
"Europe, Western",
"European Union",
"Land Locked Developing Countries",
"Least Developed Countries",
"Low Income Food Deficit Countries",
"Micronesia (region)",
"Middle Africa",
"Net Food Importing Developing Countries",
"Northern Africa",
"Northern Europe",
"Serbia and Montenegro",
"Small island developing States",
"South Eastern Asia",
"Southern Africa",
"Southern Asia",
"Southern Europe",
"Western Africa",
"World")) %>%
mutate(
entity = case_when(
entity == "Sudan (former)" ~ "Sudan",
TRUE ~ entity)) %>%
select(-code, -year) %>%
group_by(entity) %>%
summarise_if(is.numeric, sum, na.rm = TRUE) %>%
mutate(Total = rowSums(across(where(is.numeric)))) %>%
top_n(25, Total) %>%
select(-Total) %>%
pivot_longer(!entity, names_to = "category", values_to = "value") %>%
mutate(
category = case_when(
category == "human_food" ~ "Human Food",
category == "animal_feed" ~ "Animal Feed",
category == "processed" ~ "Processed",
TRUE ~ category))
View(soybean_clean)
ggplot(soybean_clean,aes(entity,value))
ggplot(soybean_clean,aes(entity,value)) +
geom_bar()
ggplot(soybean_clean,aes(entity,value)) +
geom_bar(fill = category)
ggplot(soybean_clean,aes(entity,value)) +
geom_bar()
ggplot(soybean_clean, aes(entity,value, fill = category)) +
geom_bar()
ggplot(soybean_clean, aes(entity,value, fill = category)) +
geom_col()
ggplot(soybean_clean, aes(entity,value)) +
geom_col()
ggplot(soybean_clean, aes(entity,value)) +
geom_col() +
facet_wrap(~category)
ggplot(soybean_clean, aes(value,entity)) +
geom_col() +
facet_wrap(~category)
ggplot(soybean_clean, aes(value,entity)) +
geom_col() +
coord_polar() +
facet_wrap(~category)
ggplot(soybean_clean, aes(value,entity)) +
geom_col() +
coord_polar(theta = "y") +
facet_wrap(~category)
ggplot(soybean_clean, aes(value,entity)) +
geom_col() +
coord_polar(theta = "x") +
facet_wrap(~category)
ggplot(soybean_clean, aes(value,entity)) +
geom_col() +
coord_polar(theta = "y") +
facet_wrap(~category)
ggplot(soybean_clean, aes(value,entity)) +
geom_col() +
facet_wrap(~category)
library(imager)
library(tidyverse)
library(ggvoronoi)
library(kableExtra)
library(extrafont)
library(ggtext)
setwd("C:/Users/cshog/Dropbox/CHRISTIAN/Academic Work/Github/30DayChartChallenge")
img <- load.image("abstract_image.jpg")
img_df <- as.data.frame(img)
img_df %>%
arrange(x, y, cc) %>%
filter(row_number() < 10) %>%
kable("html") %>%
kable_styling(full_width = F)
img_df <- img_df %>%
mutate(channel = case_when(
cc == 1 ~ "Red",
cc == 2 ~ "Green",
cc == 3 ~ "Blue"
))
sample_size <- 10000
img_wide <- img_df %>%
select(x, y, channel, value) %>%
spread(key = channel, value = value) %>%
mutate(
color = rgb(Red, Green, Blue)
)
img_sample <- img_wide[sample(nrow(img_wide), sample_size), ]
img_sample$size <- runif(sample_size)
ggplot(img_sample) +
geom_point(mapping = aes(x = x, y = y, color = color, size = size)) +
guides(size = FALSE) +
labs(caption = "The Gladstone Pottery Museum (Stoke-on-Trent, UK)<br><br><br><span style='font-size:12pt;'><span style='color:#9DABAC;'>#30DayChartChallenge | @CSHoggard</span></span>") +
scale_color_identity() +
scale_y_reverse() +
theme_void() +
theme(plot.caption = element_markdown(family = "Goudy Old Style", hjust = 0.5, size = 24, margin = margin(20,0,10,0)),
plot.margin = margin(20,20,20,20),
plot.background = element_rect(fill = NA, colour = 'grey40', size = 2))
ggsave("abstract.png", plot = last_plot(), height = 264, width = 268, units = "mm", dpi = 600)
